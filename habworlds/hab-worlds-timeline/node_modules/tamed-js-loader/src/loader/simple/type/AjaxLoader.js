'use strict';
tm.add ('trg.loader.simple.type.AjaxLoader', function (o, p, d) {
    p.onLoad = function (data) {
        tm.setContent ({
            alias: d.alias,
            content: data,
            name: d.url,
            queue: d.queue,
        })

        d.queue.done (o);
    }

    o.setup = function (config) {
        d.alias = config.alias;
        d.url = config.url;
        d.queue = config.queue;
        o.load ();
    }

    o.getLoadInfo = function () {
        return d.info;
    }

    o.getUrl = function () {
        return d.url;
    }

    o.load = function (data) {
        $.ajax ({
            url: d.url,
        }).done (function (data) {
            p.onLoad (data);
        })
        .fail (function () {
            var info;
            info = {
                message: 'Unable to load file: ' + d.url,
                url: d.url,
            }

            console.error (info.message)
            d.queue.done (o, info);
        })
    }
})
