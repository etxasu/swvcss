'use strict';
tm.add ('trg.loader.simple.type.HandleBars', ['trg.loader.simple.type.AjaxLoader'], function (o, p, d) {
    function parseId (data) {
        var id;

        // Parse out the id and the template.
        if (data.substring (0, 4) === '<!--' && data.indexOf ('-->') > -1) {
            id = data.substring (0, (data.indexOf ('-->') + 3));
            id = id.replace ('<!--', '').replace ('-->', '').trim ();
            data = data.substring (data.indexOf ('-->') + 3).trim ();
        }
        else {
            id = d.url;
        }

        // Return the parsed template string.
        return {
            id: id,
            template: data,
        }
    }

    p.override ({
        onLoad: function (original, data) {
            var id;

            d.info = parseId (data);
            tm.addHtml (d.info.id, d.info.template);
            original (data);
        }
    })
})
